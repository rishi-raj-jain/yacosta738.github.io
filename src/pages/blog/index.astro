---
import i18next, { t, changeLanguage } from "i18next";
import BlogTemplate from "templates:BlogTemplate";
import { Article, jsonToArticle } from "@models:Article";
import ArticleSummary from "molecules:ArticleSummary";
const postsData = await Astro.glob("./**/*.md");
const allPosts: Article[] = postsData
    .filter((post) => !post.frontmatter.draft && post.frontmatter.lang === i18next.language)
    .map((post) => jsonToArticle(post))
    .sort((a, b) => {
    let aDate = new Date(a.date);
    let bDate = new Date(b.date);
    return bDate.getTime() - aDate.getTime();
});

changeLanguage("en");
---

<BlogTemplate title={t('blog')}>
	<div class='container-inner mx-auto py-16 pl-10'>
    {
        allPosts.map((post) => (
            <div class='mb-20 border-b border-gray-400'>
                <ArticleSummary article={post} />
            </div>
        ))
    }
    {
        allPosts.length === 0 && (
            <div class='container-inner mx-auto py-16 pl-10'>
                <div class='text-center'>
                    <h1 class='text-3xl font-bold'>{t('no-articles-found')}</h1>
                    <p class='text-gray-600'>{t('try-again')}</p>
                </div>
            </div>
        )
    }
</div>
</BlogTemplate>
